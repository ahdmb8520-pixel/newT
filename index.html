<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>عداد من Google Sheet</title>
<style>
  body { font-family: sans-serif; text-align: center; margin-top: 60px; direction: rtl; }
  .count { font-size: 36px; margin: 15px; }
</style>
</head>
<body>
<h1>العدادات الحالية</h1>
<div class="count">🖊️ قلم أزرق: <span id="blue">-</span></div>
<div class="count">🖋️ قلم أخضر: <span id="green">-</span></div>
<div class="count">📏 مسطرة: <span id="ruler">-</span></div>

<script>
const CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vT2CtxC9rfEZYaYgc5ujs-ZTVhvFqt9lyJOSSYGyPddPr1w1LZOigHbHLSgABN2rL7AEfT9aEFGo8Dz/pub?gid=696352829&single=true&output=csv";

function fetchCounts() {
  fetch(CSV_URL)
    .then(response => {
      if (!response.ok) throw new Error("فشل التحميل: " + response.status);
      return response.text();
    })
    .then(csv => {
      const rows = csv.trim().split("\n").map(r => r.split(","));
      // الصف الأخير (بعد العناوين)
      const lastRow = rows[rows.length - 1];
      const blue  = lastRow[1] || "0";
      const green = lastRow[2] || "0";
      const ruler = lastRow[3] || "0";
      document.getElementById("blue").textContent  = blue;
      document.getElementById("green").textContent = green;
      document.getElementById("ruler").textContent = ruler;
    })
    .catch(err => {
      console.error(err);
      document.getElementById("blue").textContent =
        document.getElementById("green").textContent =
        document.getElementById("ruler").textContent = "خطأ";
    });
}

fetchCounts();
setInterval(fetchCounts, 5000); // تحديث كل 5 ثوانٍ
</script>
</body>
</html>
